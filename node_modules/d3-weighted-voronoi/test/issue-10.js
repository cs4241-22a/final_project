var tape = require('tape'),
  d3WeightedVoronoi = require('../build/d3-weighted-voronoi');

tape('weightedVoronoi.(...) should compute weighted voronoi diagram', function (test) {
  test.test('issue #10 use case', function (test) {
    var weightedVoronoi = d3WeightedVoronoi.weightedVoronoi(),
      newClip = [
        [1, 0],
        [-1, 0],
        [-1, -2],
        [1, -2],
      ],
      y = -0.8, // works fine
      y = -0.8999999999999999, // infinite loop
      y = -0.9, // infinite loop
      y = -0.95, // error "Process exited with code 1"
      data = [
        { x: 0.3, y: -1, weight: 1 },
        { x: -0.3, y: -1, weight: 1 },
        { x: 0.3, y: y, weight: 1 },
        { x: -0.3, y: y, weight: 1 },
      ],
      // cells = weightedVoronoi(data);
      cells = weightedVoronoi.clip(newClip)(data);

    test.equal(cells.length, 4);
    test.end();
  });
});
